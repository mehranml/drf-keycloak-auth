version: '3.7'

services:
  test:
    build:
      context: .
    environment:
      # django app config
      DEBUG: 1
      DJANGO_ALLOWED_HOSTS: "localhost 127.0.0.1 [::1]"
      KEYCLOAK_SERVER_URL: https://auth.dev.ecocommons.org.au/auth/
      KEYCLOAK_REALM: ecocommons-foobar
      KEYCLOAK_CLIENT_ID: local-dev-testing
      ### Add these in docker-compose.override.yml
      # KEYCLOAK_CLIENT_SECRET_KEY: 
      # KEYCLOAK_MULTI_OIDC_JSON: 
      # EC_TEST_USERNAME: 
      # EC_TEST_PASSWORD: 
      # USER_TEST_USERNAME: 
      # USER_TEST_PASSWORD: 
    working_dir: /srv/app/
    volumes:
      - '.:/srv/app:cached'
    command: './manage.py runserver'